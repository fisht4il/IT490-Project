<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" href="style.css">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login Form</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function () {
      $('#login-form').on('submit', function (e) {
        e.preventDefault();

        var username = $('#username').val();
        var password = $('#password').val();
        var showRawJson = $('#show-json').is(':checked');

        $.ajax({
          url: 'login.php',
          type: 'POST',
          data: {
            username: username,
            password: password
          },
          success: function (response) {
            try {
              let result = typeof response === 'string' ? JSON.parse(response) : response;
              let color = result.success ? 'green' : 'red';

              let formattedResponse = `
                <pre><strong style="color:${color};">${result.message}</strong></pre><br>
              `;

              let rawJsonResponse = showRawJson
                ? `<h4>Raw JSON Response:</h4><pre>${JSON.stringify(result, null, 2)}</pre>`
                : '';

              $('#response').html(formattedResponse + rawJsonResponse);
		
	      if (result.success && result.redirect) {
                window.location.href = result.redirect;
                return;
              }

            } catch (error) {
              console.error("JSON parse error:", error);
              $('#response').html(
                `<pre><strong style='color:red;'>Invalid JSON response.</strong></pre>`
              );
            }
          },
          error: function () {
            $('#response').html("<strong style='color:red;'>An error occurred. Please try again.</strong>");
          }
        });
      });
    });
  </script>
</head>

<body>

        <header class="main-header">
            <h1 class="page-title">IT-490-Project</h1>
            <nav class="header-nav">
                <ul class="link-list">
                    <li class="link-item">
                        <button class="btn">
                            <a href="#" class="placeholder-link">Link1</a>
                        </button>
                    </li>
                    <li class="link-item">
                        <button class="btn">
                            <a href="#" class="placeholder-link">Link2</a>
                        </button>
                    </li>
                     <li class="link-item">
                        <button class="signup">
                            <a href="/php/signup.html" class="placeholder-link">Signup</a>
                        </button>
                    </li>
                </ul>
            </nav>
        </header>

  <main class="main-section">
        <section class="login-section">
                <form action="/php/login.php"  id="login-form">
                        <h2 class="login-title">Login</h2>
                        <label for="username">Username</label><br>
                        <input type="text" class="login-input" id="username" name="username" required><br><br>

                        <label for="password">Password</label><br>
                        <input type="password" class="login-input" id="password" name="password" required><br><br>

                        <input type="submit" class="login-input" value="Login">
                        <label>
                                <br><br>Raw JSON Response<input type="checkbox" id="show-json">
                        </label>
                </form>
        </section>
  </main>
 <div id="response"></div>

  <section class="about-service">
                <p class="p-about-service">
                    Lorem ipsum dolor sit amet consectetur adipisicing elit. Excepturi cupiditate magnam vero dignissimos dolorum inventore ratione ipsum quisquam porro odit non neque, rem doloremque molestiae quaerat explicabo at aspernatur hic.
                    Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ad, aliquid! Porro explicabo dignissimos officia officiis, dolorum harum ipsa tenetur accusantium, nihil fuga deserunt ut, consectetur fugiat ipsam nobis rem vel.
                    Lorem ipsum dolor, sit amet consectetur adipisicing elit. Reiciendis accusamus aliquid tempore sit, molestias aspernatur modi rerum vel non amet dolor nam repellat dignissimos veniam quasi itaque mollitia quibusdam eos.
                </p>
        </section>

    <footer class="footer">
        <p class="copyright">&copy; 2024. Copyright by IT-490-Project</p>
    </footer>
</body>

</html>
